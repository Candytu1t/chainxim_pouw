# ======================================================================
# PoUW (Proof of Useful Work) 共识协议配置文件
# 
# 本文件包含了PoUW区块链仿真的所有参数设置
# PoUW是一种结合了传统PoW和数学优化问题的新型共识机制
# ======================================================================

[BatchSettings]
batch_enable = true
max_cores = 6
mlist = [20]
nlist = [20]       ; 矿工数量 n
Nlist = [2]         ; 优化维度 N
task_numlist = [7,8,9]
confirm_depths = [2]
adver_nums = [0]
retry_list = [20]
yuzhis = [0.1]
yuzhi_changes = [1]
iterations = 1
optimization_method = [threshold, kkt]

[EnvironmentSettings]
# 仿真环境基础设置
total_round = 200000
process_bar_type = round
miner_num = 10
blocksize = 2
consensus_type = consensus.PoUW
network_type = network.SynchronousNetwork
show_fig = False
log_level = info
compact_outputfile = False
common_prefix_enable = False
performance_analyzer_enable = False
memory_cleanup_enable = False
consensus_miner_quantile = -1

[DataItemSettings]
# 数据项设置（控制区块中包含的数据）
dataitem_enable = False # 是否启用数据项
max_block_capacity = 10 # 区块最大容量
dataitem_size = 1 # 数据项大小
dataitem_input_interval = 0 # 数据项输入间隔

[ConsensusSettings]
# ======================================================================
# PoUW共识协议核心参数设置
# 
# PoUW挖矿分为4个阶段：
# 阶段1: 段选择 (Segment Selection) - 选择挖TX/PRP/VT区块
# 阶段2: 优化计算 (Optimization) - 解决数学优化问题
# 阶段3: 有用工作证明 (Useful PoW) - 基于优化结果的PoW
# 阶段4: 纯PoW (Pure PoW) - 传统PoW后备机制
# ======================================================================
# 矿工算力设置
q_ave = 1 # 平均算力值
q_distr = equal # 算力分布方式 (equal=均等分布)
# 挖矿难度目标值 (值越小难度越高，越难出块)
target = 03126E978D4FDF3B645A1CAC083126E978D4FDF3B645A1CAC083126E978D4FDF # 阶段1难度：段选择难度
target2 = 004189374BC6A7EF9DB22D0E5604189374BC6A7EF9DB22D0E5604189374BC6A7 # 阶段3难度：有用PoW难度
target3 = 00068DB8BAC710CB295E9E1B089A027525460AA64C2F837B4A2339C0EBEDFA43 # 阶段4难度：纯PoW难度
average_block_time = 0 # 平均出块时间(0=自动)

# 多链架构设置
N = 11 # 总链数量 (1个Proposer链 + 5个Voter链)
vtnum = 10 # Voter链数量
# 优化问题参数设置
optimization_dimension = 2 # 优化问题维度 (2D问题)
search_range = 20 # 变量搜索范围 [-20, 20]
task_num = 8 # 可选优化任务数量
optimization_threshold = 0.001 # 优化收敛阈值
kkt_threshold = 0.001 # KKT条件判断阈值
retry_times = 1 # 优化失败重试次数
# ======================================================================
# 优化方法选择与配置
# ======================================================================
# optimization_method: 选择优化成功的判断标准
#   - 'kkt': KKT方法 - 需要满足KKT条件（梯度范数 < kkt_threshold）
#            适用于追求高精度优化解的场景
#   - 'threshold': 阈值方法 - 只需满足阈值改进条件（新解比旧解好一个阈值）
#                  适用于追求快速收敛的场景
optimization_method = threshold

# 阈值方法相关参数（仅在optimization_method = threshold时生效）
# threshold_base: 基础阈值值 - 控制优化成功的门槛
# threshold_change_rate: 阈值随区块高度的变化率 - 动态调整难度
# threshold_min: 最小阈值 - 防止阈值过小导致优化过于容易
threshold_base = 0.1 # 基础阈值
threshold_change_rate = 1 # 阈值变化率 (0-1)
threshold_min = 0.1 # 最小阈值

# ======================================================================
# 常用参数组合建议:
# 
# 【快速测试】- 更容易出块，适合调试
# target/target2/target3 = FFFFFFFF... (更大的值)
# optimization_method = threshold
# 
# 【标准仿真】- 平衡的难度设置
# target/target2/target3 = 00FFFFFF... (当前设置)
# optimization_method = kkt
# 
# 【高难度仿真】- 更真实的区块链环境
# target/target2/target3 = 0000FFFF... (更小的值)
# optimization_method = kkt
# ======================================================================"

[AttackSettings]
# 攻击设置（用于安全性分析）
adver_num = 0 # 恶意矿工数量
attack_type = HonestMining # 攻击类型 (HonestMining=诚实挖矿)

[DeterPropNetworkSettings]
# 确定性传播网络设置
prop_vector = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]

[StochPropNetworkSettings]
# 随机传播网络设置
rcvprob_start = 0.01
rcvprob_inc = 0.01
stat_prop_times = [0.03, 0.05, 0.08, 0.1, 0.2, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.93,0.95,0.98, 1.0]

[TopologyNetworkSettings]
# 拓扑网络设置
init_mode = adj
topology_path = conf/topologies/default_adj.csv
bandwidth_honest = 5
bandwidth_adv = 5
rand_mode = binomial
ave_degree = 5
stat_prop_times = [0.03, 0.05, 0.08, 0.1, 0.2, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.93,0.95,0.98, 1.0]
outage_prob = 0
enable_resume_transfer = True
dynamic = False
avg_tp_change_interval = 10
edge_remove_prob = 0.05
edge_add_prob = 0.1
max_allowed_partitions = 1
save_routing_history = True
save_routing_graph = False
show_label = False

[AdHocNetworkSettings]
# AdHoc网络设置
init_mode = rand
ave_degree = 5
segment_size = 0.5
region_width = 100
comm_range = 30
move_variance = 5
outage_prob = 0
enable_large_scale_fading = True
path_loss_level = medium
bandwidth_max = 15
stat_prop_times = [0.03, 0.05, 0.08, 0.1, 0.2, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.93,0.95,0.98, 1.0]

